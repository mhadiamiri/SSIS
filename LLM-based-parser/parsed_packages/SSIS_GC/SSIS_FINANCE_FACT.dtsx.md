## 1. Input Connection Analysis

| Connection Manager Name   | Connection Type | Connection String Details  | Purpose within Package                                         | Security Requirements | Parameters/Variables | Source Part |
|---------------------------|-----------------|---------------------------|----------------------------------------------------------------|-----------------------|-----------------------|-------------|
| MART_GC_REPORTING        | OLE DB          | Server: [Inferred], Database: [Inferred]          | Destination for fact tables, lookup data             | SQL Server Auth Likely          | None                  | Part 1, 2, 3                 |
| GC_STAGING   | OLE DB          | Server: [Inferred], Database: [Inferred]          | Source for staging data used in lookups           | SQL Server Auth Likely              | None                  | Part 1, 2, 3                 |
|GC_SOURCE  | OLE DB          | Server: [Inferred], Database: [Inferred]          | Source for configuration tables used in lookups   | SQL Server Auth Likely            | None                  | Part 1, 2, 3                 |

## 2. Package Dependencies

| Dependent Package Name   | Package Full Path | Parent-Child Relationship  | Execution Conditions/Constraints  | Notes                               | Source Part |
|--------------------------|-------------------|------------------------------|-----------------------------------|-------------------------------------|-------------|
| None Found |                     |                                  |                                     | No dependent SSIS packages tasks found   | Part 1, 2, 3|

## 3. Package Flow Analysis

The SSIS package `SSIS_FINANCE_FACT` performs the following main steps:

1.  **Expression Task:** `EXPRESSIONT- FINANCE Fact Tables - Start Task - ProcessDataFlowNode` - An expression task that evaluates `1 == 1`. This appears to be a placeholder.
2.  **Sequence Container:** `SEQC-F_2_F_GC_ACCOUNTING_DOC_LINE_ITEM` - Loads and transforms data into the `F_GC_ACCOUNTING_DOC_LINE_ITEM` fact table.
    *   Drops and recreates indexes on `F_GC_ACCOUNTING_DOC_LINE_ITEM` (Execute SQL Tasks).
    *   Truncates `F_GC_ACCOUNTING_DOC_LINE_ITEM` and `F_GC_FUNDS_RESERVATION_ITEM` (Execute SQL Tasks).
    *   Loads temporary tables (`S_GC_PROJECT_WBS_TMP_K`, `T10A`, `T4A`, `T5A`, etc.) using Data Flow Tasks.
    *   Inserts data into `F_GC_ACCOUNTING_DOC_LINE_ITEM` using a complex `INSERT...SELECT` statement (Execute SQL Task).

    *   **DFT-Load\_ S\_GC\_PROJECT\_WBS\_TMP**: Loads data from staging table `S_GC_PROJECT_WBS` to temporary table `S_GC_PROJECT_WBS_TMP_K`.
    *   **DFT-Load\_T10A**: Loads data from staging table `D_GC_FUND` and a configuration table `ZOAT_GEBER_MAP` to temporary table `T10A`.
    *   **DFT-Load\_T16A**: Loads data from staging table `D_GC_COMMITMENT_ITEM` and a configuration table `ZOAT_FIPEX_MAP` to temporary table `T16A`.
    *   **DFT-Load\_T18A**: Loads data from staging table `D_GC_COST_CENTRE` and a configuration table `ZOAT_KOSTL_MAP` to temporary table `T18A`.
    *   **DFT-Load\_T4A**: Loads data from staging table `D_GC_GL_ACCOUNT` and a configuration table `ZOAT_SAKNR_MAP` to temporary table `T4A`.

    *   **DFT-Load\_T5A**: Loads data from staging table `D_GC_VENDOR` and a configuration table `ZOAT_LFB1_MAP` to temporary table `T5A`.
    *   **DFT-Load\_T5A\_DEEMED**: Loads data from staging table `D_GC_VENDOR` and a configuration table `ZOAT_LFB1_MAP` to temporary table `T5A_DEEMED`.
3.  **Sequence Container:** `SEQC_FACTS_1_F_GC_ACCOUNTING_DOCUMENT` - Loads and transforms data into the `F_GC_ACCOUNTING_DOCUMENT` fact table.
    *   Drops and recreates indexes on `F_GC_ACCOUNTING_DOCUMENT` (Execute SQL Tasks).
    *   Truncates `F_GC_ACCOUNTING_DOCUMENT` (Execute SQL Task).
    *   Loads `D_GC_FISCAL_DATE_TMP_K` (Data Flow Task)
    *   Inserts data into `F_GC_ACCOUNTING_DOCUMENT` using a complex `INSERT...SELECT` statement (Execute SQL Task).
4.  **Sequence Container:** `SEQC_F_GC_ANNUAL_BUDGET` - Loads and transforms data into the `F_GC_ANNUAL_BUDGET` fact table.
    *   Truncates `F_GC_ANNUAL_BUDGET` and `F_GC_ORDER` (Execute SQL Task).
    *   Drops and recreates indexes on `F_GC_ANNUAL_BUDGET` (Execute SQL Task).
    *   Loads temporary tables (`S_GC_ANNUAL_BUDGET_TMP_K`, `ZOAT_GEBER_MAP_TMP_K`, `ZOAT_KOSTL_MAP_TMP_K`, `ZOAT_FICTR_MAP_TMP_K`, etc.) using Data Flow Tasks.
    *   Loads data into temporary staging tables.
    *  **DFT-F\_GC\_ORDER**: Reads from the `S_GC_ORDER` and `D_GC_ORDER` staging tables and stores data into the `F_GC_ORDER` fact table.
    *   Loads and transforms data into the `F_GC_ANNUAL_BUDGET` fact table (Data Flow Task).
5.  **Sequence Container:** `SEQC_F_GC_FUNDS_RESERVATION_ITEM` - Loads and transforms data into the `F_GC_FUNDS_RESERVATION_ITEM` fact table.
    *   Truncates `F_GC_FUNDS_RESERVATION_ITEM`
    *   Drops and recreates indexes on `F_GC_FUNDS_RESERVATION_ITEM` (Execute SQL Tasks).
    *   Loads temporary tables (`S_GC_FUNDS_RESERVATION_ITEM_TMP_K`, `ZOAT_GEBER_MAP_TMP_K`, `ZOAT_KOSTL_MAP_TMP_K`, `ZOAT_FICTR_MAP_TMP_K`, etc.) using Data Flow Tasks.
    *   Loads data into temporary staging tables.
    *   Inserts data into `F_GC_FUNDS_RESERVATION_ITEM` using a complex `INSERT...SELECT` statement (Execute SQL Task).

### Error Handling

*   `OnError` event handler updates the `ETL_RUN_STATUS` table with a 'FAILED' status.
*   The `FailComponent` setting on several Data Flow Tasks will stop the package on error.

## 4. Code Extraction

```markdown
DROP INDEX IF Exists [XPKF_GC_ACCOUNTING_DOC_LINE_ITEM] ON [dbo].[F_GC_ACCOUNTING_DOC_LINE_ITEM];

DROP INDEX IF Exists [XIF4F_GC_ACCOUNTING_DOC_LINE_ITEM] ON [dbo].[F_GC_ACCOUNTING_DOC_LINE_ITEM] ;

DROP INDEX IF Exists [XIE10F_GC_ACCOUNTING_DOC_LINE_ITEM] ON [dbo].[F_GC_ACCOUNTING_DOC_LINE_ITEM];

DROP INDEX IF Exists [XIE11F_GC_ACCOUNTING_DOC_LINE_ITEM] ON [dbo].[F_GC_ACCOUNTING_DOC_LINE_ITEM];

DROP INDEX IF Exists [XIE12F_GC_ACCOUNTING_DOC_LINE_ITEM] ON [dbo].[F_GC_ACCOUNTING_DOC_LINE_ITEM];

DROP INDEX IF Exists [XIE13F_GC_ACCOUNTING_DOC_LINE_ITEM] ON [dbo].[F_GC_ACCOUNTING_DOC_LINE_ITEM];

DROP INDEX IF Exists [XIE14F_GC_ACCOUNTING_DOC_LINE_ITEM] ON [dbo].[F_GC_ACCOUNTING_DOC_LINE_ITEM];

DROP INDEX IF Exists [XIE1F_GC_ACCOUNTING_DOC_LINE_ITEM] ON [dbo].[F_GC_ACCOUNTING_DOC_LINE_ITEM];

DROP INDEX IF Exists [XIE2F_GC_ACCOUNTING_DOC_LINE_ITEM] ON [dbo].[F_GC_ACCOUNTING_DOC_LINE_ITEM];

DROP INDEX IF Exists [XIE3F_GC_ACCOUNTING_DOC_LINE_ITEM] ON [dbo].[F_GC_ACCOUNTING_DOC_LINE_ITEM];

DROP INDEX IF Exists [XIE4F_GC_ACCOUNTING_DOC_LINE_ITEM] ON [dbo].[F_GC_ACCOUNTING_DOC_LINE_ITEM];

DROP INDEX IF Exists [XIE5F_GC_ACCOUNTING_DOC_LINE_ITEM] ON [dbo].[F_GC_ACCOUNTING_DOC_LINE_ITEM];

DROP INDEX IF Exists [XIE6F_GC_ACCOUNTING_DOC_LINE_ITEM] ON [dbo].[F_GC_ACCOUNTING_DOC_LINE_ITEM];

DROP INDEX IF Exists [XIE7F_GC_ACCOUNTING_DOC_LINE_ITEM] ON [dbo].[F_GC_ACCOUNTING_DOC_LINE_ITEM];

DROP INDEX IF Exists [XIE8F_GC_ACCOUNTING_DOC_LINE_ITEM] ON [dbo].[F_GC_ACCOUNTING_DOC_LINE_ITEM];
```

Context: SQL code to drop indexes on the  `F_GC_ACCOUNTING_DOC_LINE_ITEM` table. This is part of the  `SEQC-F_2_F_GC_ACCOUNTING_DOC_LINE_ITEM` Sequence Container.

```markdown
CREATE UNIQUE CLUSTERED INDEX [XPKF_GC_ACCOUNTING_DOC_LINE_ITEM] ON [dbo].[F_GC_ACCOUNTING_DOC_LINE_ITEM]
(
	[ACCOUNTING_DOCUMENT_ITEM_SID] ASC) WITH  (FILLFACTOR = 100 ) ON [PRIMARY]
;

CREATE NONCLUSTERED INDEX [XIF4F_GC_ACCOUNTING_DOC_LINE_ITEM] 
ON [dbo].[F_GC_ACCOUNTING_DOC_LINE_ITEM] ([DEEMED_VENDOR_SID])
INCLUDE ([ACCOUNTING_DOCUMENT_SID],[WBS_LEVEL_3_SID],[FUND_SID],[FISCAL_YEAR_SID],[FC_SID],[LOCAL_CURRENCY_AMT])
;

CREATE NONCLUSTERED INDEX [XIE10F_GC_ACCOUNTING_DOC_LINE_ITEM] ON [dbo].[F_GC_ACCOUNTING_DOC_LINE_ITEM]
(
	[ORDER_SID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
;

CREATE NONCLUSTERED INDEX [XIE11F_GC_ACCOUNTING_DOC_LINE_ITEM] ON [dbo].[F_GC_ACCOUNTING_DOC_LINE_ITEM]
(
	[FUNDS_RESERVATION_DOC_SID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
;

CREATE NONCLUSTERED INDEX [XIE12F_GC_ACCOUNTING_DOC_LINE_ITEM] ON [dbo].[F_GC_ACCOUNTING_DOC_LINE_ITEM]
(
	[FUNDS_RESERVATION_ITEM_SID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
;

CREATE NONCLUSTERED INDEX [XIE13F_GC_ACCOUNTING_DOC_LINE_ITEM] ON [dbo].[F_GC_ACCOUNTING_DOC_LINE_ITEM]
(
	[FC_SID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
;

CREATE NONCLUSTERED INDEX [XIE14F_GC_ACCOUNTING_DOC_LINE_ITEM] ON [dbo].[F_GC_ACCOUNTING_DOC_LINE_ITEM]
(
	[FUND_SID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
;

CREATE NONCLUSTERED INDEX [XIE1F_GC_ACCOUNTING_DOC_LINE_ITEM] ON [dbo].[F_GC_ACCOUNTING_DOC_LINE_ITEM]
(
	[COMMITMENT_ITEM_SID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
;

CREATE NONCLUSTERED INDEX [XIE2F_GC_ACCOUNTING_DOC_LINE_ITEM] ON [dbo].[F_GC_ACCOUNTING_DOC_LINE_ITEM]
(
	[WBS_LEVEL_3_SID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
;

CREATE NONCLUSTERED INDEX [XIE3F_GC_ACCOUNTING_DOC_LINE_ITEM] ON [dbo].[F_GC_ACCOUNTING_DOC_LINE_ITEM]
(
	[FISCAL_YEAR_SID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
;

CREATE NONCLUSTERED INDEX [XIE4F_GC_ACCOUNTING_DOC_LINE_ITEM] ON [dbo].[F_GC_ACCOUNTING_DOC_LINE_ITEM]
(
	[TRANSACTION_TYPE_SID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
;

CREATE NONCLUSTERED INDEX [XIE5F_GC_ACCOUNTING_DOC_LINE_ITEM] ON [dbo].[F_GC_ACCOUNTING_DOC_LINE_ITEM]
(
	[COST_CENTRE_SID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
;

CREATE NONCLUSTERED INDEX [XIE6F_GC_ACCOUNTING_DOC_LINE_ITEM] ON [dbo].[F_GC_ACCOUNTING_DOC_LINE_ITEM]
(
	[PURCHASE_ORDER_SID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
;

CREATE NONCLUSTERED INDEX [XIE7F_GC_ACCOUNTING_DOC_LINE_ITEM] ON [dbo].[F_GC_ACCOUNTING_DOC_LINE_ITEM]
(
	[PO_LINE_ITEM_SID] ASC,
	[CUSTOMER_SID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
;

CREATE NONCLUSTERED INDEX [XIE8F_GC_ACCOUNTING_DOC_LINE_ITEM] ON [dbo].[F_GC_ACCOUNTING_DOC_LINE_ITEM]
(
	[GL_ACCOUNT_SID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
;
```

Context: SQL code to recreate indexes on the  `F_GC_ACCOUNTING_DOC_LINE_ITEM` table. This is part of the  `SEQC-F_2_F_GC_ACCOUNTING_DOC_LINE_ITEM` Sequence Container.
```markdown
TRUNCATE TABLE F_GC_ACCOUNTING_DOC_LINE_ITEM;

TRUNCATE TABLE F_GC_FUNDS_RESERVATION_ITEM;
```

Context: SQL code to truncate fact tables.

```markdown
INSERT INTO DBO.F_GC_ACCOUNTING_DOC_LINE_ITEM
SELECT [ACCOUNTING_DOCUMENT_ITEM_SID]
      ,[ACCOUNTING_DOCUMENT_SID]
      ,[WBS_LEVEL_3_SID]
      ,[TRANSACTION_TYPE_SID]
      ,[COST_CENTRE_SID]
      ,[PURCHASE_ORDER_SID]
      ,[PO_LINE_ITEM_SID]
      ,[FUND_SID]
      ,[COMMITMENT_ITEM_SID]
      ,[FISCAL_YEAR_SID]
      ,[CUSTOMER_SID]
      ,[GL_ACCOUNT_SID]
      ,[TRADING_PARTNER_COMPANY_NBR]
      ,[VENDOR_SID]
      ,[DEEMED_VENDOR_SID]
      ,[ORDER_SID]
      ,[FUNDS_RESERVATION_DOC_SID]
      ,[FUNDS_RESERVATION_ITEM_SID]
      ,[FC_SID]
      ,[ACCOUNT_ASSIGNMENT_SERIAL_NBR]
      ,[CLEARING_DT]
      ,[CLEARING_DTM]
      ,[CLEARING_ENTRY_DT]
      ,[CLEARING_ENTRY_DTM]
      ,[ASSET_VALUE_DT]
      ,[ASSET_VALUE_DTM]
      ,[LOCAL_CURRENCY_AMT]
      ,[DOCUMENT_CURRENCY_AMT]
      ,[ORIGINAL_REDUCTION_AMT]
      ,[GL_UPDATE_AMT]
      ,[ORGNL_LOCL_CURNCY_TAX_BASD_AMT]
      ,[ORGNL_DOC_CURNCY_TAX_BASE_AMT]
      ,[LOCAL_CURRENCY_TAX_AMT]
      ,[DOCUMENT_CURRENCY_TAX_AMT]
      ,[LOCAL_CURRENCY_TAX_BASE_AMT]
      ,[DOCUMENT_CURNCY_TAX_BASE_AMT]
      ,[ROW_INSERT_DT]
      ,GETDATE() AS [ETL_CREA_DT]
      ,GETDATE() AS [ETL_UPDT_DT]
  FROM (
select 
ISNULL(T15.ACCOUNTING_DOCUMENT_ITEM_SID, '-3') as ACCOUNTING_DOCUMENT_ITEM_SID,
ISNULL(T2.ACCOUNTING_DOCUMENT_SID, '-3') as ACCOUNTING_DOCUMENT_SID,
ISNULL(T3.CUSTOMER_SID, '-3') as CUSTOMER_SID,

CASE
  WHEN T4A.GL_ACCOUNT_SID IS NOT NULL THEN T4A.GL_ACCOUNT_SID
  WHEN T4B.GL_ACCOUNT_SID IS NOT NULL THEN T4B.GL_ACCOUNT_SID
else '-3' end as GL_ACCOUNT_SID,

CASE
  WHEN T5A.VENDOR_SID IS NOT NULL THEN T5A.VENDOR_SID
  WHEN T5B.VENDOR_SID IS NOT NULL THEN T5B.VENDOR_SID
else '-3' end as VENDOR_SID,

CASE
  WHEN T5A_DEEMED.VENDOR_SID IS NOT NULL THEN T5A_DEEMED.VENDOR_SID
  WHEN T5B_DEEMED.VENDOR_SID IS NOT NULL THEN T5B_DEEMED.VENDOR_SID
  WHEN T5C_DEEMED.VENDOR_SID IS NOT NULL THEN T5C_DEEMED.VENDOR_SID
else '-3' end as DEEMED_VENDOR_SID,

ISNULL(T6.ORDER_SID, '-3') as ORDER_SID,
ISNULL(T7.FUNDS_RESERVATION_DOC_SID, '-3') as FUNDS_RESERVATION_DOC_SID,
ISNULL(T8.FUNDS_RESERVATION_ITEM_SID, '-3') as FUNDS_RESERVATION_ITEM_SID,

CASE
  WHEN T9A.FC_SID IS NOT NULL THEN T9A.FC_SID
  WHEN T9B.FC_SID IS NOT NULL THEN T9B.FC_SID
else '-3' end as FC_SID,

CASE
  WHEN T10A.FUND_SID IS NOT NULL THEN T10A.FUND_SID
  WHEN T10B.FUND_SID IS NOT NULL THEN T10B.FUND_SID
else '-3' end as FUND_SID,

ISNULL(T12.TRANSACTION_TYPE_SID, '-3') as TRANSACTION_TYPE_SID,
ISNULL(T13.PO_LINE_ITEM_SID, '-3') as PO_LINE_ITEM_SID,

ISNULL(T14.WBS_LEVEL_3_SID, '-3') as WBS_LEVEL_3_SID,
Fd.FISCAL_DATE_SID as FISCAL_YEAR_SID,

CASE
  WHEN T16A.COMMITMENT_ITEM_SID IS NOT NULL THEN T16A.COMMITMENT_ITEM_SID
  WHEN T16B.COMMITMENT_ITEM_SID IS NOT NULL THEN T16B.COMMITMENT_ITEM_SID
else '-3' end as COMMITMENT_ITEM_SID,

CASE
  WHEN T18A.COST_CENTRE_SID IS NOT NULL THEN T18A.COST_CENTRE_SID
  WHEN T18B.COST_CENTRE_SID IS NOT NULL THEN T18B.COST_CENTRE_SID
else '-3' end as COST_CENTRE_SID,

ISNULL(T19.PURCHASE_ORDER_SID, '-3') as PURCHASE_ORDER_SID,

CASE t1.DEBIT_CREDIT_CD
                WHEN 'H' THEN (-1*T1.DOCUMENT_CURRENCY_AMT)
                ELSE T1.DOCUMENT_CURRENCY_AMT
END AS DOCUMENT_CURRENCY_AMT,
CASE t1.DEBIT_CREDIT_CD
                WHEN 'H' THEN (-1*T1.ORIGINAL_REDUCTION_AMT)
                ELSE T1.ORIGINAL_REDUCTION_AMT
END AS ORIGINAL_REDUCTION_AMT,
CASE t1.DEBIT_CREDIT_CD
                WHEN 'H' THEN (-1*T1.GL_UPDATE_AMT)
                ELSE T1.GL_UPDATE_AMT
END AS GL_UPDATE_AMT,
CASE t1.DEBIT_CREDIT_CD
                WHEN 'H' THEN (-1*T1.ORGNL_LOCL_CURNCY_TAX_BASD_AMT)
                ELSE T1.ORGNL_LOCL_CURNCY_TAX_BASD_AMT
END AS ORGNL_LOCL_CURNCY_TAX_BASD_AMT,
CASE t1.DEBIT_CREDIT_CD
                WHEN 'H' THEN (-1*T1.ORGNL_DOC_CURNCY_TAX_BASE_AMT)
                ELSE T1.ORGNL_DOC_CURNCY_TAX_BASE_AMT
END AS ORGNL_DOC_CURNCY_TAX_BASE_AMT,
CASE t1.DEBIT_CREDIT_CD
                WHEN 'H' THEN (-1*T1.LOCAL_CURRENCY_TAX_BASE_AMT)
                ELSE T1.LOCAL_CURRENCY_TAX_BASE_AMT
END  AS LOCAL_CURRENCY_TAX_BASE_AMT,
CASE t1.DEBIT_CREDIT_CD
                WHEN 'H' THEN (-1*T1.DOCUMENT_CURNCY_TAX_BASE_AMT)
                ELSE T1.DOCUMENT_CURNCY_TAX_BASE_AMT
END AS DOCUMENT_CURNCY_TAX_BASE_AMT,
CASE t1.DEBIT_CREDIT_CD
                WHEN 'H' THEN (-1*T1.LOCAL_CURRENCY_AMT)
                ELSE T1.LOCAL_CURRENCY_AMT
END  AS LOCAL_CURRENCY_AMT,
CASE t1.DEBIT_CREDIT_CD
                WHEN 'H' THEN (-1*T1.LOCAL_CURRENCY_TAX_AMT)
                                ELSE T1.LOCAL_CURRENCY_TAX_AMT
END AS LOCAL_CURRENCY_TAX_AMT,
CASE t1.DEBIT_CREDIT_CD
                WHEN 'H' THEN (-1*T1.DOCUMENT_CURRENCY_TAX_AMT)
                ELSE T1.DOCUMENT_CURRENCY_TAX_AMT
END AS DOCUMENT_CURRENCY_TAX_AMT,

ISNULL(T1.ACCOUNT_ASSIGNMENT_SERIAL_NUM, '-3') as ACCOUNT_ASSIGNMENT_SERIAL_NBR,
CAST(T1.CLEARING_DT as NVARCHAR(11)) as CLEARING_DT,
CAST(T1.CLEARING_DT as DateTime2) as CLEARING_DTM,
CAST(T1.CLEARING_ENTRY_DT as NVARCHAR(11)) as CLEARING_ENTRY_DT,
CAST(T1.CLEARING_ENTRY_DT as Datetime2) as CLEARING_ENTRY_DTM,
CAST(T1.ASSET_VALUE_DT as NVARCHAR(11)) as ASSET_VALUE_DT ,
CAST(T1.ASSET_VALUE_DT as Datetime2) as ASSET_VALUE_DTM ,
T1.TRADING_PARTNER_COMPANY_NBR,
CAST( getdate() as date) as ROW_INSERT_DT
-- SELECT COUNT(*)--23644804
--select *
FROM dbo.D_GC_ACCOUNTING_DOC_LINE_ITEM T15 --> 7693821

JOIN dbo.S_GC_ACCOUNTING_DOC_LINE_ITEM_TMP_K T1
	on T1.ACCOUNTING_DOCUMENT_NBR = T15.ACCOUNTING_DOCUMENT_NBR
    and T1.ACCOUNTING_DOCUMENT_ITEM_NUM = T15.ACCOUNTING_DOCUMENT_ITEM_NBR
	and T1.FY = T15.FY

left Join dbo.D_GC_ACCOUNTING_DOCUMENT T2
	on  T2.FY = T1.FY
	and T2.ACCOUNTING_DOCUMENT_NBR = T1.ACCOUNTING_DOCUMENT_NBR


LEFT JOIN dbo.D_GC_PURCHASE_ORDER T19 --> 7691114
on T1.PO_DOCUMENT_NBR = T19.PO_DOCUMENT_NBR
and (T1.SOURCE_ID = T19.SOURCE_ID
		or T1.PO_DOCUMENT_NBR like '5%')

left join dbo.D_GC_TRANSACTION_TYPE T12
on T1.TRANSACTION_TYPE_CD = T12.TRANSACTION_TYPE_CD

left join dbo.D_GC_CUSTOMER T3
on T3.CUSTOMER_NBR = T1.CUSTOMER_NBR
--and T3.SOURCE_ID = T1.SOURCE_ID --Fixed by Jenny

LEFT JOIN dbo.D_GC_FUND T10B
    on T1.FUND_NBR = T10B.FUND_NBR
--    AND T10B.SOURCE_ID = T1.SOURCE_ID  --Fixed by Jenny

LEFT JOIN dbo.T10A
                on T1.FUND_NBR = T10A.FUND_NBR
          AND T10A.SOURCE_ID = 'FAS'
          AND T1.SOURCE_ID = 'GCS'

LEFT JOIN  dbo.T4A
                on T1.GL_ACCOUNT_NBR = T4A.GL_ACCOUNT_NBR
          AND T4A.SOURCE_ID = 'FAS'
          AND T1.SOURCE_ID = 'GCS'

LEFT JOIN dbo.D_GC_GL_ACCOUNT  T4B
    on T1.GL_ACCOUNT_NBR = T4B.GL_ACCOUNT_NBR
          AND T4B.SOURCE_ID = T1.SOURCE_ID

LEFT JOIN  dbo.T5A
                on T1.VENDOR_NBR COLLATE Latin1_General_CI_AS = T5A.VENDOR_NBR COLLATE Latin1_General_CI_AS
          AND T5A.SOURCE_ID = 'FAS'
          AND T1.SOURCE_ID = 'GCS'

LEFT JOIN dbo.D_GC_VENDOR T5B
        on T1.VENDOR_NBR COLLATE Latin1_General_CI_AS = T5B.VENDOR_NBR COLLATE Latin1_General_CI_AS
          AND T5B.SOURCE_ID = T1.SOURCE_ID

LEFT JOIN T5A_DEEMED
                on T1.DEEMED_VENDOR_NBR COLLATE Latin1_General_CI_AS = T5A_DEEMED.VENDOR_NBR COLLATE Latin1_General_CI_AS
          AND T5A_DEEMED.SOURCE_ID = 'FAS'
          AND T1.SOURCE_ID = 'GCS'

LEFT JOIN dbo.D_GC_VENDOR T5B_DEEMED
        on T1.DEEMED_VENDOR_NBR COLLATE Latin1_General_CI_AS = T5B_DEEMED.VENDOR_NBR COLLATE Latin1_General_CI_AS
          AND T5B_DEEMED.SOURCE_ID = T1.SOURCE_ID

LEFT JOIN dbo.D_GC_VENDOR T5C_DEEMED
	ON T1.TRADING_PARTNER_COMPANY_NBR = T5C_DEEMED.VENDOR_NBR

left join dbo.D_GC_ORDER T6
on t6.ORDER_NBR = T1.ORDER_NBR
and t6.SOURCE_ID = T1.SOURCE_ID

left join dbo.D_GC_FUNDS_RESERVATION_DOCUMENT T7
on T1.FUNDS_RESERVATION_DOC_NUM = T7.FUNDS_REVERVATION_DOCUMENT_NBR
and T1.SOURCE_ID = T7.SOURCE_ID

left join dbo.D_GC_FUNDS_RESERVATION_ITEM T8
on T1.FUNDS_RESERVATION_DOC_NUM= T8.FUNDS_REVERVATION_DOCUMENT_NBR
  and T1.FUNDS_RESERVATION_ITEM_NUM = T8.FUNDS_RESERVATION_ITEM_NBR

LEFT JOIN dbo.T9A
                on T1.FUND_CENTRE_NBR = T9A.FUND_CENTRE_CD
          AND T9A.SOURCE_ID = 'FAS'
          AND T1.SOURCE_ID = 'GCS'

LEFT JOIN dbo.D_GC_FUND_CENTRE T9B
         on T1.FUND_CENTRE_NBR  = T9B.FUND_CENTRE_CD
 --        AND T9B.SOURCE_ID = T1.SOURCE_ID

Left join dbo.D_GC_PO_LINE_ITEM T13
on T1.PO_DOCUMENT_NBR = T13.PO_DOCUMENT_NBR
and T1.PO_LINE_ITEM_NBR = T13.PO_LINE_ITEM_NBR
and (T1.SOURCE_ID = T13.SOURCE_ID
		or T1.PO_DOCUMENT_NBR like '5%')

-- TFS 236 modify condition for the join to D_GC_FISCAL_DATE in order to get the correct FISCAL_PERIOD_SID
-- left JOIN GC_Reporting.dbo.D_GC_FISCAL_DATE FD
--	on FD.FISCAL_YEAR = T1.FY and FD.FISCAL_PERIOD = '000'

-- join to accouting document staging table to retreive the fiscal period
left join dbo.S_GC_ACCOUNTING_DOCUMENT_TMP_K sa
	on T1.ACCOUNTING_DOCUMENT_NBR = sa.ACCOUNTING_DOCUMENT_NBR and T1.FY = sa.FY

left join [dbo].D_GC_FISCAL_DATE_TMP_K FD
   on FD.FISCAL_YEAR = T2.FY and FD.FISCAL_PERIOD = cast(sa.FISCAL_PERIOD_NBR as int)

LEFT JOIN dbo.T16A
                on T1.COMMITMENT_ITEM_KEY = T16A.COMMITMENT_ITEM_NBR
          AND T16A.SOURCE_ID = 'FAS'
          AND T1.SOURCE_ID = 'GCS'

LEFT JOIN dbo.D_GC_COMMITMENT_ITEM  T16B
        on T1.COMMITMENT_ITEM_KEY = T16B.COMMITMENT_ITEM_NBR
          AND T16B.SOURCE_ID = T1.SOURCE_ID

LEFT JOIN dbo.T18A
                on T1.COST_CENTRE_NBR = T18A.COST_CENTRE_NBR
          AND T18A.SOURCE_ID = 'FAS'
          AND T1.SOURCE_ID = 'GCS' 

       LEFT JOIN dbo.D_GC_COST_CENTRE T18B
       -- on rtrim(cast(T1.COST_CENTRE_NBR as varchar(20))) = T18B.COST_CENTRE_NBR
             on  T1.COST_CENTRE_NBR  = T18B.COST_CENTRE_NBR
       AND T18B.SOURCE_ID = T1.SOURCE_ID --

LEFT join 

```

Context: SQL code to insert into  `F_GC_ACCOUNTING_DOC_LINE_ITEM`. The code joins several dimension tables to retreive the surrogate keys.

```markdown
DROP TABLE IF EXISTS [dbo].[T10A];
DROP TABLE IF EXISTS [dbo].[T4A];
DROP TABLE IF EXISTS [dbo].[T5A]

DROP TABLE IF EXISTS [dbo].[T5A_DEEMED]
DROP TABLE IF EXISTS [dbo].[T9A]

DROP TABLE IF EXISTS [dbo].[T16A]

DROP TABLE IF EXISTS [dbo].[T18A]

DROP TABLE IF EXISTS [dbo].[S_GC_PROJECT_WBS_TMP_K]

CREATE TABLE [dbo].[S_GC_PROJECT_WBS_TMP_K](
 [WBS_NBR] [varchar](24) NOT NULL,
 [GCS_WBS_NBR] [varchar](24) NOT NULL,
 [UPDATE_DT] [datetime] NULL,
 [OBJECT_NBR] [varchar](22) NOT NULL,
 [INTERNAL_WBS_NBR] [varchar](8) NOT NULL,
 [WBS_NM] [varchar](40) NOT NULL,
 [